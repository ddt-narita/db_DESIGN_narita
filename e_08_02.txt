演習08-02
アドホックなデータを用意する手段としてDBMSは「一時テーブル」というものを用意する
「一時テーブル」について調べ使うことの是非を考える。
作成日：6月19日
作成者：成田修之

一時テーブル
基本的には普通のテーブルと同じものとして考えられるテーブル。使用されなくなると、自動的に
されるという点だけが異なる。一時テーブルには2種類あり、作成したユーザーが接続している間のみ
表示され、切断されると削除されるテーブルをローカル一時テーブル、すべてのユーザーに表示され、
そのテーブルを参照するすべてのユーザーが切断すると削除されるグローバル一時テーブルがある。
ユーザーが使うときのみ表示されるのでデータとしてメモリを消費するわけでもなく実に実用的な
ものに感じた。調べていて書いてあったのは、そのテーブルはあくまで一時テーブルなのでそれがのちに
必要になることなどが想定される場合には切断する前にテーブルの保存を忘れないようにしなければならない。



解説
SELECT分のこすとがかからず、データを不要になったら削除されるので有用に感じるが
いくつかの重大な欠点がある
1．情報統計の収集タイミングが難しい
SQL文を実行するときには統計情報をもとに実行計画を決定することになるが、一時テーブルでは
初めは件数が0であり、統計情報が取れるのが必要な情報をすべて入力しきってからということになる。
一時テーブルとはいえデータが膨大になれば統計情報の取得にもそれなりに時間がかかるので、
一時テーブルを使うときというのはすぐにそのデータをつかいたいときが多いが入れてすぐ使えるわけ
ではなく統計情報収集という処理を一段階踏まなければならないことに注意

2．IO分散
RDBでは5種類のファイルによって管理されているが一時テーブルは一時ファイルに保存される。
テーブルではあるがデータファイルには保存されない。通常はデータファイルに最も高性能なスペック
のストレージを割り当てるが一時テーブルを使うときには使えないことに注意


以上のことから一時テーブル自体を使うことはグレーノウハウではないが、使うときには
かなり性能的に厳しい条件下での設計が求められるということに注意
